/**!
* BlogToc v1.1.0
* Copyright 2013 Cluster Amaryllis
* Licensed under the Apache License v2.0
* http://www.apache.org/licenses/LICENSE-2.0
* 
* A javascript plugin to make table of contents for blogspot using Blogger Feed API.
*/
!function(){"use strict";var c=function(){!function(){var c="1.1.0",d="//googledrive.com/host/0B-ME4OmVndQzMFNaMWpqVzVYUFE/"+c+"/",e="#|A|B|C|D|E|F|G|H|I|J|K|L|M|N|O|P|Q|R|S|T|U|V|W|X|Y|Z".split("|"),f="Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday".split("|"),g="January|February|March|April|May|June|July|August|September|October|November|December".split("|"),h="https://lh4.googleusercontent.com/-QhzzNTYkzbE/AAAAAAAAAAI/AAAAAAAAAAA/voMJT6RfB_o/s1600/photo.jpg",i="http://3.bp.blogspot.com/-trkoRRazZ7A/UdtEVufkxiI/AAAAAAAABxI/DOJ7jAUv1G4/s1600/blank.gif",j="http://3.bp.blogspot.com/-p7gZDNwTJbw/UdkqBnBb1bI/AAAAAAAAALI/hoCIpF74N80/s1600/image_not_available.jpg",k="http://s20.postimg.org/7oz0eeuyx/blank.gif",l=/.*?:\/\/|\/$/g,m=/s\d+\-?\w?/gi,n=/(^\s+|\s{2,}|\s+$)/g,o=/(<([^>]+)>)/gi,p=/^(index|thumbnail)$/i,q=/^(actualImage|authorThumbnail|badge|category|commentURL|fullSummary|publishDateFormat|titleURL|thumbConfig|updateDateFormat)$/i,r={},s={},t="en-US",u="bootstrap",v=function(a,b){if(!a.BTID){var c,d,v,w,A,C,D,G,H,K,L,M,O=a;O.BTAPP={run:function(a){var b=this,e={blogtocId:"",date:{day:f,month:g,render:function(a,b){return b.date.day[a.getDay()]+", "+b.date.month[a.getMonth()]+" "+a.getDate()+" "+a.getFullYear()}},display:{setup:10,template:[5,10,25,50,"All"]},extendClass:{},feedType:"default",label:{setup:"All",setupAlphabet:"All",define:[],exception:!1,showLabel:!0,cloudLabel:!1,showAlphabetLabel:!0,cloudAlphabetLabel:!0,includeLabelAll:!0,includeAlphabetLabelAll:!0},language:{setup:t,custom:{}},newBadge:{setup:5,render:function(a){return'<span class="label">'+a+"</span>"}},pagination:{adjacents:2},progress:{render:function(a,b){var c;(c=a.getElementsByTagName("span")[0])?c.innerHTML=b:a.innerHTML="Loading <span>"+b+"</span> %"}},search:{markerRender:function(a){return"<b>"+a+"</b>"}},sorting:{key:"title",order:"ascending"},summary:{wordLimit:200},theme:{setup:u},table:{order:"index;thumbnail;title;publishDate;updateDate;author;comment",initDataLoad:10,showHeader:!0,indexWidthPoint:2.5,authorWidthPoint:10.5,commentWidthPoint:9,publishDateWidthPoint:12.5,summaryWidthPoint:25,thumbnailWidthPoint:7,titleWidthPoint:28,updateDateWidthPoint:12.5},thumbnail:{blank:i,notFound:j,sample:k,size:72,authorSize:36,authorThumbnail:!0},url:"googleblog.blogspot.com"};c=O.BTOptions=R(e,a),v=O.BTFeed={data:[],label:[],count:0},d=O.BTConfig={cache:{},iotf:{},iterate:0,order:{},registeredEvent:{},searchRegex:null,searchState:!1},_(c.language.setup,s,c.language.custom),ab(c.theme.setup,r,c.extendClass),w=O.BTID,A=w.firstChild,C=E(A),D=E(C),G=E(D),H=E(G),y(w,c.extendClass.blogtoc_id),y(A,c.extendClass.blogtoc_loader),y(C,c.extendClass.blogtoc_header),y(D,c.extendClass.blogtoc_filter),y(G,c.extendClass.blogtoc_table),y(H,c.extendClass.blogtoc_footer),c.progress.render(A,0),d.cache.req=new Array,d.cache.thead={},d.nat=h.replace(m,"s"+c.thumbnail.authorSize+"-c"),d.iotf=fb(c.thumbnail.sample),d.mapper=c.table.order.split(";"),d.mapperWidth=new Array,d.tbwrapper="display:block;width:"+c.thumbnail.size+"px;height:"+c.thumbnail.size+"px;",d.tbimg="width:"+c.thumbnail.size+"px;height:"+c.thumbnail.size+"px;",d.records=c.display.setup||c.display.template[0],d.page=1,d.pageState=1,window["BTJSONCallback_"+w.id]=function(a){b.initFeed(a)};var n=c.url.replace(l,""),o=n+"_"+X();n="//"+n+"/feeds/posts/summary/?"+"max-results=0&"+"alt=json-in-script&"+"callback=BTJSONCallback_"+w.id,d.cache.req[0]=o;var p=function(){setTimeout(function(){d.iotf.server?N(n,o,function(){alert(c.language.custom.errorMessage),F(w)}):p()},1e3)};p()},initFeed:function(a){var b=this,f=a.feed;if("openSearch$totalResults"in f&&(v.count=f.openSearch$totalResults.$t),"category"in f)for(var g=c.label.define,h=g.length,i=c.label.exception,j=0,k=f.category.length;k>j;j++){var m=f.category[j].term;h&&(i&&J(m,g)||!i&&!J(m,g))||v.label.push(f.category[j].term)}v.label.sort(function(a,b){return a.toLowerCase()>b.toLowerCase()?1:-1}),c.label.includeLabelAll&&v.label.unshift(c.language.custom.labelAll),M=e.slice(0),c.label.includeAlphabetLabelAll&&M.unshift(c.language.custom.labelAll),window["BTLDJSONCallback_"+w.id]=function(a){b.loadFeed(a)};var n,j=0,o=0,p=Math.ceil(v.count/500),q=c.url.replace(l,"");for(q="//"+q+"/feeds/posts/"+c.feedType+"/?"+"max-results=500&"+"alt=json-in-script&"+"callback=BTLDJSONCallback_"+w.id;p>j;j++)o=500*j+1,n=q+"_"+X(),d.cache.req[j+1]=n,N(q+"&start-index="+o,n)},loadFeed:function(a){var b=this,e=a.feed,f=[],g={},h=v.data,i=v.count,j=c.thumbnail.size,k=(c.thumbnail.authorSize,c.thumbnail.notFound),l=c.summary.wordLimit,p=c.date.render,q=d.iotf.server,r=c.progress.render;if("entry"in e){var s=0,t=e.entry.length,u=function(){setTimeout(function(){var a=e.entry[s];g.title=a.title.$t.replace(n,"");var v=a.published.$t.substring(0,10).split("-"),w=a.published.$t.substring(11,19).split(":"),x=a.updated.$t.substring(0,10).split("-"),y=a.updated.$t.substring(11,19).split(":");g.publishDateFormat=U(v,w),g.updateDateFormat=U(x,y),g.publishDate=p(g.publishDateFormat,c),g.updateDate=p(g.updateDateFormat,c);var z,B="summary"in a?a.summary.$t:"content"in a?a.content.$t:"";z=B.replace(o,"").replace(n,""),z.length>l&&(z=z.substring(0,l),z=z.substring(0,z.lastIndexOf(" "))+"...."),g.fullSummary=B,g.summary=z;var C;g.thumbConfig={},"media$thumbnail"in a?(g.thumbnail=a.media$thumbnail.url,g.actualImage=g.thumbnail.replace(m,"s0"),g.thumbnail=g.thumbnail.replace("/s72-c/","/s"+j+"-c/")):(C=/<img [^>]*src=["|\']([^"|\']+)/gi.exec(B))?(g.actualImage=C[1],g.thumbnail=Y(g.actualImage,j,q)):(g.actualImage=k,g.thumbnail=m.test(g.actualImage)?g.actualImage.replace(m,"s"+j+"-c"):Y(g.actualImage,j,q));for(var D=0;D<a.link.length;D++)"replies"===a.link[D].rel?g.commentURL=a.link[D].href:"alternate"===a.link[D].rel&&(g.titleURL=a.link[D].href);if(g.commentURL||(g.commentURL="#"),g.comment="thr$total"in a?+a.thr$total.$t:0,g.author=a.author[0].name.$t,g.authorThumbnail=a.author[0].gd$image.src.replace(m,"s"+j+"-c"),"category"in a)for(var D=0;D<a.category.length;D++)f.push(a.category[D].term);g.category=f.slice(0),h.push(g),g={},f.length=0,d.iterate++,s++;var E=Math.round(100*d.iterate/i);r(A,E),t>s&&u(),d.iterate>=i&&setTimeout(function(){A.style.display="none",b.buildUI()},1)},1)};u()}},buildUI:function(){var a,b=this,e=c.extendClass,f=(c.thumbnail.size,c.sorting.order),g=c.sorting.key,h="BlogToc.label(this, this.value, document.getElementById('"+w.id+"')); return false;",i="BlogToc.alphabet(this, this.value, document.getElementById('"+w.id+"')); return false;",j="BlogToc.display(this.value, document.getElementById('"+w.id+"')); return false;",k="BlogToc.search(this.value, document.getElementById('"+w.id+"')); return false;";b.makeLabel(v.label,"showLabel","cloudLabel","setup","blogtoc_label",h),b.makeLabel(M,"showAlphabetLabel","cloudAlphabetLabel","setupAlphabet","blogtoc_alphabet",i);var l,m,n,o,r,s,t,u=I(c.display.setup,c.display.template),x=0,A=u.length;for(m=z("div",null,null,"blogtoc_display"),y(m,e.blogtoc_display),s=z("label"),n=z("select",{onchange:j}),t=document.createTextNode(" "+c.language.custom.display);A>x;x++)l="string"==typeof u[x]?v.count:u[x],r=z("option",{value:l},u[x]),u[x]===c.display.setup&&(r.selected=!0),n.appendChild(r);s.appendChild(n),s.appendChild(t),m.appendChild(s),D.appendChild(m),m=z("div",null,null,"blogtoc_search"),y(m,e.blogtoc_search),s=z("label"),t=document.createTextNode(c.language.custom.search+" "),o=z("input",{type:"text",onkeyup:k},null,"blogtoc_query"),y(o,e.blogtoc_query),s.appendChild(t),s.appendChild(o),m.appendChild(s),D.appendChild(m);var C,E,J,N,O,P,Q,x=0,R=d.mapper.length;for(b.calculate(),J=z("thead"),N=z("tr");R>x;x++)C=d.mapper[x],a="BlogToc.sort('"+C+"', document.getElementById('"+w.id+"')); return false;",O=z("th",{width:d.mapperWidth[x]}),q.test(C)||(p.test(C)?P=document.createTextNode(c.language.custom[C]):(Q=z("span",null,null,"icon-menu"),P=z("a",{href:"javascript:void(0)",onclick:a},c.language.custom[C]),P.appendChild(Q),d.cache.thead[C]=Q),d.order[C]=null,O.appendChild(P),N.appendChild(O));J.appendChild(N),E=G.firstChild;try{G.style.display="table"}catch(S){G.style.display="block"}G.insertBefore(J,E),c.table.showHeader||F(J),K=z("div",null,null,"blogtoc_result"),y(K,e.blogtoc_result),H.appendChild(K),L=z("div",null,null,"blogtoc_pagination"),y(L,e.blogtoc_pagination),H.appendChild(L),b.addBadge(),d.cache.thead[g].className="ascending"===f?"icon-arrow-up-4":"icon-arrow-down-5",d.order[g]=f,b.doSorting(g,f),c.label.showLabel||c.label.showAlphabetLabel?(d.currentLabel=c.label.showLabel?c.label.setup:null,d.currentAlphabet=c.label.showAlphabetLabel?c.label.setupAlphabet:null,c.label.showLabel?b.displayLabel(d.currentLabel,null,null,!0):b.displayAlphabet(d.currentAlphabet,null,null,!0)):b.compile(),window["BTJSONCallback_"+w.id]=null,window["BTLDJSONCallback_"+w.id]=null;for(var T=0,U=d.cache.req.length;U>T;T++)F(B(d.cache.req[T]))},buildPagination:function(){var a,b,e,f,g=c.extendClass,h=g["blogtoc_pagination ul"],i=g["blogtoc_pagination current"],j=g["blogtoc_pagination disabled"],k=Math.ceil(v.data.length/d.records),l=d.page,m=l+1,n=l-1,o=l+6,p=l+46,q=l-6,r=l-46,s=c.pagination.adjacents,t=2*s,u=w.id;if(k>1){if(b=z("ul",null,null,h),l>1?(f=Z(1,c.language.custom.firstPage,"a",u),b.appendChild(f),f=Z(n,c.language.custom.prevPage,"a",u)):f=Z(null,c.language.custom.prevPage,"span",u,j),b.appendChild(f),7+t>k)for(a=1;k>=a;a++)f=a===l?Z(null,a,"span",u,i):Z(a,a,"a",u),b.appendChild(f);else if(k>5+t){if(r-t>1&&(a=r-t,f=Z(a,a,"a",u),b.appendChild(f)),q-t>1&&(a=q-t,f=Z(a,a,"a",u),b.appendChild(f)),2+t>l){for(a=1;4+t>a;a++)f=a===l?Z(null,a,"span",u,i):Z(a,a,"a",u),b.appendChild(f);f=Z(null,"...","span",u),b.appendChild(f)}else if(k-t>l&&l>1+t){for(f=Z(null,"...","span",u),b.appendChild(f),a=l-s;l+s>=a;a++)f=a===l?Z(null,a,"span",u,i):Z(a,a,"a",u),b.appendChild(f);f=Z(null,"...","span",u),b.appendChild(f)}else for(f=Z(null,"...","span",u),b.appendChild(f),a=k-(2+t);k>=a;a++)f=a===l?Z(null,a,"span",u,i):Z(a,a,"a",u),b.appendChild(f);k>o+t&&(a=o+t,f=Z(a,a,"a",u),b.appendChild(f)),k>p+t&&(a=p+t,f=Z(a,a,"a",u),b.appendChild(f))}k>l?(f=Z(m,c.language.custom.nextPage,"a",u),b.appendChild(f),f=Z(k,c.language.custom.lastPage,"a",u)):f=Z(null,c.language.custom.nextPage,"span",u,j),b.appendChild(f)}(e=L.getElementsByTagName("ul")[0])?b?L.replaceChild(b,e):L.removeChild(e):b?L.appendChild(b):null},makeLabel:function(a,b,d,e,f,g){var h,i,j,k=0,l=a.length,m=!1;if(c.label[b]){if(c.label[d]){for(i=z("div",null,null,f);l>k;k++)h=a[k]===c.language.custom.labelAll?"All":a[k],j=z("button",{type:"button",value:h,onclick:g},a[k]),y(j,c.extendClass.blogtoc_button),h===c.label[e]&&(j.disabled=!0,m=!0),i.appendChild(j);m||(c.label[e]=i.firstChild.getAttribute("value"),i.firstChild.disabled=!0)}else{for(i=z("select",{onchange:g},null,f);l>k;k++)h=a[k]===c.language.custom.labelAll?"All":a[k],j=z("option",{value:h},a[k]),h===c.label[e]&&(j.selected=!0,m=!0),i.appendChild(j);m||(c.label[e]=i.firstChild.value,i.firstChild.selected=!0)}C.appendChild(i)}},buildResult:function(){var a=v.data.length,b=d.page*d.records,e={begin:a?(d.page-1)*d.records+1:0,end:a>b?b:a,total:a},f=c.language.custom.result.replace(/\{(.*?)\}/gi,function(a,b){return"<b>"+e[b]+"</b>"});K.innerHTML=f},displayLabel:function(a,b,c,e){var f=this;if(e&&(v.data=d.cache.original.slice(0)),e&&null!=d.currentAlphabet&&f.displayAlphabet(d.currentAlphabet,null,!0),null!=d.currentLabel){if(""===a&&(a=b.getAttribute("value")),d.currentLabel=a,"All"!==a){for(var g=new Array,h=0,i=v.data.length;i>h;h++)J(a,v.data[h].category)&&g.push(v.data[h]);v.data=g.slice(0)}if(d.cache.tempData=v.data.slice(0),!c){if(b&&"button"===b.tagName.toLowerCase()){for(var j=b.parentNode.childNodes,h=j.length;h--;)j[h].disabled=!1;b.disabled=!0}d.page=1,d.pageState=1;var k;(k=D.getElementsByTagName("input")[0].value)?f.query(k):f.compile()}}},displayAlphabet:function(a,b,c,e){var f=this;if(e&&(v.data=d.cache.original.slice(0)),e&&null!=d.currentLabel&&f.displayLabel(d.currentLabel,null,!0),null!=d.currentAlphabet){if(""===a&&(a=b.getAttribute("value")),d.currentAlphabet=a,"All"!==a){var g,h=new Array;g="#"===a?new RegExp("^[^A-Z]{1,}.*","i"):new RegExp("^"+a+"{1,}.*","i");for(var i=0,j=v.data.length;j>i;i++)~v.data[i].title.search(g)&&h.push(v.data[i]);v.data=h.slice(0)}if(d.cache.tempData=v.data.slice(0),!c){if(b&&"button"===b.tagName.toLowerCase()){for(var k=b.parentNode.childNodes,i=k.length;i--;)k[i].disabled=!1;b.disabled=!0}d.page=1,d.pageState=1;var l;(l=D.getElementsByTagName("input")[0].value)?f.query(l):f.compile()}}},sorting:function(a){var b=this,c=d.order,e=d.cache.thead;if(v.data.length){for(var f in e)a!==f?(e[f].className="icon-menu",c[f]="descending"):(e[f].className="ascending"===c[f]?"icon-arrow-down-5":"icon-arrow-up-4",c[f]="ascending"===c[f]?"descending":"ascending");b.doSorting(a,c[a]),b.compile()}},doSorting:function(a,b){var e=v.data,f=c.date.day,g=d.cache;g[a]=g[a]||{},v.data="ascending"===b?cb(e,a,f).slice(0):cb(e,a,f).slice(0).reverse(),g.original=g.original?"ascending"===b?cb(g.original,a,f).slice(0):cb(g.original,a,f).slice(0).reverse():v.data.slice(0)},changeDisplay:function(a){var b=this;d.records=+a,v.data[(d.page-1)*d.records]||(d.page=1),b.compile()},query:function(a){var b=this;if(a=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),v.data=d.cache.tempData?d.cache.tempData.slice(0):d.cache.original.slice(0),a){d.searchRegex=new RegExp(a,"igm"),d.searchState=!0,d.page=1;for(var c=new Array,e=0,f=v.data.length;f>e;e++)~v.data[e].title.search(d.searchRegex)&&c.push(v.data[e]);v.data=c.slice(0)}else{var g=Math.ceil(v.data.length/d.records);d.searchRegex=null,d.page=d.pageState<=g?d.pageState:1}d.searchState&&b.compile()},changePage:function(a){var b=this;d.page=+a,d.pageState=d.page,window.scroll(w.offsetLeft,w.offsetTop),b.compile()},addBadge:function(){var a=this;a.doSorting("publishDate","descending");for(var b=v.data,d=0,e=b.length,f=c.newBadge.setup,g=c.newBadge.render(c.language.custom.newLabel);e>d;d++)f?(b[d].badge='<span class="blogtoc_badge">'+g+"</span>",f--):b[d].badge='<span class="blogtoc_badge" style="display:none;"></span>'},calculate:function(){for(var a,b=0,e=d.mapper.length,f=d.mapper,g=c.table,h=0;e>b;b++)h+=g[f[b]+"WidthPoint"];for(b=0;e>b;b++)a=Math.round(100*(g[f[b]+"WidthPoint"]/h)),d.mapperWidth.push(a+"%")},compile:function(){var a,b,c=this;d.cache.img=new Array,d.cache.aimg=new Array,d.cache.feedLeft=0,d.searchRegex||(d.searchState=!1),a=z("tbody");var e=function(a,b){if(b){var c,e,f,g,h=a.parentNode,i=h.BTConfig,j=h.BTOptions,k=h.BTFeed,l=new Number((d.page-1)*d.records+i.cache.feedLeft),m=l+j.table.initDataLoad,n=d.page*i.records,o=k.data.length,p=(j.thumbnail.authorSize,l),q=l,r=i.mapper.length;for(o||b.getElementsByTagName("tr")[0]||(f=z("tr"),g=z("td",{colSpan:r},j.language.custom.noRecords,"blogtoc_norecords"),f.appendChild(g),b.appendChild(f));m>p;p++){if(p>=n||p>=o)return;e=k.data[p],i.cache.feedLeft++,q++,f=z("tr");for(var s=0;r>s;s++)c=i.mapper[s],g=z("td"),g.appendChild($(c,q,e,j,i,g)),f.appendChild(g);b.appendChild(f)}}};e(w,a),c.buildResult(),c.buildPagination();var f=function(a){var b=a.clientHeight,c=window.innerHeight||document.documentElement.clientHeight,d=window.pageYOffset||document.documentElement.scrollTop,f=a.getElementsByTagName("tbody")[0];100>b-c-d&&e(a,f)},g=function(){bb(O.BTConfig.cache.img,O.BTOptions.thumbnail.notFound),bb(O.BTConfig.cache.aimg,O.BTConfig.nat),f(O.BTID)};g(),x(d.registeredEvent,window,"scroll",g),x(d.registeredEvent,window,"resize",g),(b=G.getElementsByTagName("tbody")[0])?G.replaceChild(a,b):G.appendChild(a)}};var P=function(){setTimeout(function(){(s[t]&&!T(s[t])||!T(b.language)&&s[b.language.setup])&&(r[u]&&!T(r[u])||!T(b.theme)&&r[b.theme.setup])?(O.BTID.style.display="block",O.BTAPP.run(b)):P()},100)};P()}};Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}));var w=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},x=function(a,b,c,d){a[b]=a[b]||{},a[b][c]||(a[b][c]=d,w(b,c,d))},y=function(a,b){if(b){var c,d,e=0;if(!b&&"string"!=typeof b)return;if(c=b.split(/\s+/),1===a.nodeType)if(a.className||1!==c.length){for(d=" "+a.className+" ";e<c.length;e++)-1===d.indexOf(" "+c[e]+" ")&&(d+=c[e]+" ");a.className=d.trim()}else a.className=b}},z=function(a,b,c,d){var e=document.createElement(a);if("object"==typeof b)for(var f in b)"style"==f?e.style.cssText=b[f]:/^on/i.test(f)?e[f]=new Function(b[f]):e.setAttribute?e.setAttribute(f,b[f]):e[f]=b[f];return c&&(e.innerHTML=c),d&&(e.className=d),e},A=function(a){var b=a.getBoundingClientRect();return b.top>=0&&b.left>=0&&b.top<=(window.innerHeight||document.documentElement.clientHeight)},B=function(a){return document.getElementById(a)},C=function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName},D=function(a,b){return b=Object.prototype.toString.call(a),"object"==typeof a&&/^\[object (HTMLCollection|NodeList|Object)\]$/.test(b)&&"number"==typeof a.length&&"undefined"!=typeof a.item&&(0===a.length||"object"==typeof a[0]&&a[0].nodeType>0)},E=function(a,b){for(b=a.nextSibling;b&&1!==b.nodeType;)b=b.nextSibling;return b},F=function(a){a.parentNode.removeChild(a)},G=function(a,b){return b=z("div"),b.innerHTML=a,b.firstChild},H=function(a,b,c){for(var d=0,e=a.length;e>d;d++)if(c=new RegExp(a[d],"gi"),c.test(b))return d;return-1},I=function(c,d){return J(c,d)||array.push(c),d.sort=function(){return a-b},d},J=function(a,b){return!!~b.indexOf(a)},K=function(a){for(var b,c,d=arguments,e=d.length;e>1&&a.length;)for(b=d[--e];-1!==(c=a.indexOf(b));)a.splice(c,1);return a},L=function(a,b){if(document.createStyleSheet)document.createStyleSheet(W(a),0);else{var c=document.createElement("link");c.type="text/css",c.rel="stylesheet",c.href=W(a);var d=document.getElementsByTagName("head")[0];b?d.insertBefore(c,d.childNodes[d.childNodes.length-1]):setTimeout(function(){d.appendChild(c)},1e3)}},M=function(a,b){for(var c=document.getElementsByTagName("head")[0],d=c.getElementsByTagName("link"),e=d.length,f=a.substr(a.lastIndexOf("/"));e--;)if(d[e].href&&~d[e].href.lastIndexOf(f))return;L(a,b)},N=function(a,b,c,d){var e=document.createElement("script");e.type="text/javascript",e.src=W(a),b&&(e.id=b),c&&("onreadystatechange"in e?e.onreadystatechange=function(){("loaded"==this.readyState||"complete"==this.readyState)&&(200!=this.status&&304!=this.status&&c(),e.onreadystatechange=null)}:e.onerror=c),d||(e.async=!0),document.getElementsByTagName("head")[0].appendChild(e)},O=function(a,b,c,d){for(var e=document.getElementsByTagName("script"),f=e.length,g=a.substr(a.lastIndexOf("/"));f--;)if(e[f].src&&~e[f].src.lastIndexOf(g))return;N(a,b,d)},P=function(a,b){return a?b?a+" "+b:a:b?b:""},Q=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]="object"==typeof b[c]?Q(a[c],b[c]):P(b[c],a[c]));return a},R=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]="object"==typeof b[c]?R(a[c],b[c]):b[c]);return a},S=function(a,b){for(var c in b)b.hasOwnProperty(c)&&("object"==typeof b[c]?a[c]=S(a[c],b[c]):"boolean"==typeof a[c]||"number"==typeof a[c]||a[c]||(a[c]=b[c]));return a},T=function(a){for(var b in a)return!1;return!0},U=function(a,b){return new Date(parseInt(a[0],10),parseInt(a[1]-1,10),parseInt(a[2],10),parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10))},V=function(a,b){return Math.floor(Math.random()*(b-a+1)+a)},W=function(a){var b=new RegExp("^((ftp|https?)?:?\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return b.test(a)?a:(0===a.indexOf("/")&&(a=a.substring(1)),d+a)},X=function(){return(new Date).getTime()+V(1,1e3)},Y=function(a,b,c){var d=parseInt(1.5*b,10),e={boxsizer:"http://proxy.boxresizer.com/convert?resize="+d+"x"+d+"&"+"source="+a,sencha:"http://src.sencha.io/"+d+"/"+d+"/"+a,google:"https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?resize_w="+d+"&resize_h="+d+"&"+"url="+a+"&"+"container=focus"};return e[c]},Z=function(a,b,c,d,e){var f={a:{href:"javascript:void(0)",onclick:"BlogToc.page("+a+", document.getElementById('"+d+"')); return false;"},span:null},g=z("li",null,null,e),h=z(c,f[c],b);return g.appendChild(h),g},$=function(a,b,c,d,e,f,g){return g={author:function(){var a=z("span",null,c.author),b=z("div",null,null,"blogtoc_authorthumbnail");if(d.thumbnail.authorThumbnail){var f=d.thumbnail.authorSize,g=z("img",{src:d.thumbnail.blank,style:"width:"+f+"px;height:"+f+"px;","data-src":c.authorThumbnail,"data-loaded":"no"},null,"bt-thumb");b.appendChild(g),e.cache.aimg.push(g)}return b.appendChild(a),b},comment:function(){return z("a",{href:c.commentURL},'<span class="icon icon-comment-2"></span> '+c.comment.toString())},index:function(){return document.createTextNode(b)},thumbnail:function(){var a=z("img",{src:d.thumbnail.blank,style:e.tbimg,"data-src":c.thumbnail,"data-loaded":"no"},null,"bt-thumb"),b=z("a",{href:c.actualImage,style:e.tbwrapper},null,"blogtoc_thumbnail");return b.appendChild(a),e.cache.img.push(a),b},title:function(){var a,b;return a=e.searchRegex?c.title.replace(e.searchRegex,function(a){return d.search.markerRender(a)}):c.title,b=z("a",{href:c.titleURL,title:c.summary},a),f.appendChild(b),G(c.badge)},def:function(){return document.createTextNode(c[a])}},a in g&&g[a]()||g.def()},_=function(a,b,c){S(c,b[a].options)},ab=function(a,b,c){if(b&&b[a]){var d=function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b["blogtoc_"+c]=a[c]);return b};Q(c,d(b[a].options)),M(b[a].url,!0)}},bb=function(a,b){if(a.length){for(var c=0,d=a.length;d>c&&("yes"===a[c].getAttribute("data-loaded")||!A(a[c]));c++);if(a[c]){var e=function(){a[c]&&(a[c].removeAttribute("width"),a[c].removeAttribute("height"),a[c].onload=function(){this.setAttribute("data-loaded","yes"),K(a,this),d>c&&A(this)&&e()},a[c].onerror=function(){this.setAttribute("data-loaded","yes"),this.src=b,K(a,this),d>c&&A(this)&&e()},a[c].src=a[c].getAttribute("data-src"))};e()}}},cb=function(a,b,c,d){return a.length?(d=~H(c,a[0][b])?function(a,c){return a[b+"Format"]-c[b+"Format"]}:"string"==typeof a[0][b]?function(a,c){return a[b].toLowerCase()>c[b].toLowerCase()?1:-1}:function(a,c){return a[b]-c[b]},a.sort(d)):a},db=function(a,b){var c=b?b:"blogtoc_"+X(),d=['<div id="'+c+'" style="zoom: 1; display: none;">','<div class="blogtoc_loader"></div>','<div class="blogtoc_header"></div>','<div class="blogtoc_filter"></div>','<table class="blogtoc_table" style="display: none;"></table>','<div class="blogtoc_footer"></div>',"</div>"].join("");return a?a.innerHTML=d:document.write(d),B(c)},eb=function(a){var b=a.BTID,c=b.firstChild,d=E(c),e=E(d),f=E(e),g=E(f);c.innerHTML="",d.innerHTML="",e.innerHTML="",f.innerHTML="",g.innerHTML="",b.style.display="block",c.style.display="block",f.style.display="none"},fb=function(a){var b,c={},d=0,e=new Image,f=[["boxsizer","http://proxy.boxresizer.com/convert?resize=1x1&source="+a],["google","https://images1-focus-opensocial.googleusercontent.com/gadgets/proxy?url="+a+"&container=focus&resize_w=1&resize_h=1"],["sencha","http://src.sencha.io/1/1/"+a]];b=f.length;var g=function(){e.src=f[d][1],e.onload=function(){c.server=f[d][0]},e.onerror=function(){d++,g()}};return g(),c},gb=function(a,b){if(D(b)){a.blogtocId=null;for(var c=0,d=b.length;d>c;c++)this.__BlogTocBuilder(a,b[c])}else if(C(b))b.BTID=db(b,a.blogtocId),v(b,a);else{var e=db(null,a.blogtocId);b=e.parentNode,b.BTID=e,v(b,a)}},hb=function(a){this.element=a};hb.prototype.build=function(a){return gb(a,this.element),this};var ib=function(a){return new hb(a)};ib.build=function(a,b){return gb(a,b),this},ib.reset=function(a){return a.BTID?(eb(a),a.BTAPP.run(a.BTOptions),this):this},ib.display=function(a,b){return b.parentNode.BTAPP.changeDisplay(a),this},ib.label=function(a,b,c){return c.parentNode.BTAPP.displayLabel(b,a,null,!0),this},ib.alphabet=function(a,b,c){return c.parentNode.BTAPP.displayAlphabet(b,a,null,!0),this},ib.page=function(a,b){return b.parentNode.BTAPP.changePage(a),this},ib.search=function(a,b){return b.parentNode.BTAPP.query(a),this},ib.sort=function(a,b){return b.parentNode.BTAPP.sorting(a),this},ib.language=function(a,b){return s[a]={},s[a].options=b,this},ib.theme=function(a,b,c){return r[a]={},r[a].url=b,r[a].options=c,this},ib.addCSS=function(a,b){return M(a,b),this},ib.addJS=function(a,b,c,d){return O(a,b,c,d),this},ib.baseURL=function(a){return d=a,this},window.BlogToc=ib}()};"undefined"!=typeof window&&(c(),BlogToc.addCSS("//cdn.jsdelivr.net/bootmetro/1.0.0a1/css/bootmetro-icons.min.css"),BlogToc.addJS("lang/en-US.js"),BlogToc.addJS("theme/bt_bootstrap.js"))}();